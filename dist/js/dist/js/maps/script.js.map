{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","src/js/index.js","node_modules/browserify/node_modules/process/browser.js","node_modules/getusermedia/index-browser.js","node_modules/raf/index.js","node_modules/raf/node_modules/performance-now/lib/performance-now.js","node_modules/whammy/whammy.js","src/js/components/Application/index.js","src/js/components/BottomBar/index.js","src/js/components/CaptureMedia/index.js","src/js/components/CaptureMedia/record.js","src/js/components/ChatMessage/index.js"],"names":[],"mappings":"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","file":"script.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","var Application = require('./components/Application');\n\nvar socket = io.connect();\nvar app = Application({socket: socket});\nReact.renderComponent(app, document.body);","// shim for using process in browser\n\nvar process = module.exports = {};\n\nprocess.nextTick = (function () {\n    var canSetImmediate = typeof window !== 'undefined'\n    && window.setImmediate;\n    var canMutationObserver = typeof window !== 'undefined'\n    && window.MutationObserver;\n    var canPost = typeof window !== 'undefined'\n    && window.postMessage && window.addEventListener\n    ;\n\n    if (canSetImmediate) {\n        return function (f) { return window.setImmediate(f) };\n    }\n\n    var queue = [];\n\n    if (canMutationObserver) {\n        var hiddenDiv = document.createElement(\"div\");\n        var observer = new MutationObserver(function () {\n            var queueList = queue.slice();\n            queue.length = 0;\n            queueList.forEach(function (fn) {\n                fn();\n            });\n        });\n\n        observer.observe(hiddenDiv, { attributes: true });\n\n        return function nextTick(fn) {\n            if (!queue.length) {\n                hiddenDiv.setAttribute('yes', 'no');\n            }\n            queue.push(fn);\n        };\n    }\n\n    if (canPost) {\n        window.addEventListener('message', function (ev) {\n            var source = ev.source;\n            if ((source === window || source === null) && ev.data === 'process-tick') {\n                ev.stopPropagation();\n                if (queue.length > 0) {\n                    var fn = queue.shift();\n                    fn();\n                }\n            }\n        }, true);\n\n        return function nextTick(fn) {\n            queue.push(fn);\n            window.postMessage('process-tick', '*');\n        };\n    }\n\n    return function nextTick(fn) {\n        setTimeout(fn, 0);\n    };\n})();\n\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\n// TODO(shtylman)\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\n","// getUserMedia helper by @HenrikJoreteg\nvar func = (window.navigator.getUserMedia ||\n            window.navigator.webkitGetUserMedia ||\n            window.navigator.mozGetUserMedia ||\n            window.navigator.msGetUserMedia);\n\n\nmodule.exports = function (constraints, cb) {\n    var options;\n    var haveOpts = arguments.length === 2;\n    var defaultOpts = {video: true, audio: true};\n    var error;\n    var denied = 'PermissionDeniedError';\n    var notSatified = 'ConstraintNotSatisfiedError';\n\n    // make constraints optional\n    if (!haveOpts) {\n        cb = constraints;\n        constraints = defaultOpts;\n    }\n\n    // treat lack of browser support like an error\n    if (!func) {\n        // throw proper error per spec\n        error = new Error('MediaStreamError');\n        error.name = 'NotSupportedError';\n        return cb(error);\n    }\n\n    if (localStorage && localStorage.useFirefoxFakeDevice === \"true\") {\n        constraints.fake = true;\n    }\n\n    func.call(window.navigator, constraints, function (stream) {\n        cb(null, stream);\n    }, function (err) {\n        var error;\n        // coerce into an error object since FF gives us a string\n        // there are only two valid names according to the spec\n        // we coerce all non-denied to \"constraint not satisfied\".\n        if (typeof err === 'string') {\n            error = new Error('MediaStreamError');\n            if (err === denied) {\n                error.name = denied;\n            } else {\n                error.name = notSatified;\n            }\n        } else {\n            // if we get an error object make sure '.name' property is set\n            // according to spec: http://dev.w3.org/2011/webrtc/editor/getusermedia.html#navigatorusermediaerror-and-navigatorusermediaerrorcallback\n            error = err;\n            if (!error.name) {\n                // this is likely chrome which\n                // sets a property called \"ERROR_DENIED\" on the error object\n                // if so we make sure to set a name\n                if (error[denied]) {\n                    err.name = denied;\n                } else {\n                    err.name = notSatified;\n                }\n            }\n        }\n\n        cb(error);\n    });\n};\n","var now = require('performance-now')\n  , global = typeof window === 'undefined' ? {} : window\n  , vendors = ['moz', 'webkit']\n  , suffix = 'AnimationFrame'\n  , raf = global['request' + suffix]\n  , caf = global['cancel' + suffix] || global['cancelRequest' + suffix]\n  , isNative = true\n\nfor(var i = 0; i < vendors.length && !raf; i++) {\n  raf = global[vendors[i] + 'Request' + suffix]\n  caf = global[vendors[i] + 'Cancel' + suffix]\n      || global[vendors[i] + 'CancelRequest' + suffix]\n}\n\n// Some versions of FF have rAF but not cAF\nif(!raf || !caf) {\n  isNative = false\n\n  var last = 0\n    , id = 0\n    , queue = []\n    , frameDuration = 1000 / 60\n\n  raf = function(callback) {\n    if(queue.length === 0) {\n      var _now = now()\n        , next = Math.max(0, frameDuration - (_now - last))\n      last = next + _now\n      setTimeout(function() {\n        var cp = queue.slice(0)\n        // Clear queue here to prevent\n        // callbacks from appending listeners\n        // to the current frame's queue\n        queue.length = 0\n        for(var i = 0; i < cp.length; i++) {\n          if(!cp[i].cancelled) {\n            try{\n              cp[i].callback(last)\n            } catch(e) {\n              setTimeout(function() { throw e }, 0)\n            }\n          }\n        }\n      }, Math.round(next))\n    }\n    queue.push({\n      handle: ++id,\n      callback: callback,\n      cancelled: false\n    })\n    return id\n  }\n\n  caf = function(handle) {\n    for(var i = 0; i < queue.length; i++) {\n      if(queue[i].handle === handle) {\n        queue[i].cancelled = true\n      }\n    }\n  }\n}\n\nmodule.exports = function(fn) {\n  // Wrap in a new function to prevent\n  // `cancel` potentially being assigned\n  // to the native rAF function\n  if(!isNative) {\n    return raf.call(global, fn)\n  }\n  return raf.call(global, function() {\n    try{\n      fn.apply(this, arguments)\n    } catch(e) {\n      setTimeout(function() { throw e }, 0)\n    }\n  })\n}\nmodule.exports.cancel = function() {\n  caf.apply(global, arguments)\n}\n","(function (process){\n// Generated by CoffeeScript 1.6.3\n(function() {\n  var getNanoSeconds, hrtime, loadTime;\n\n  if ((typeof performance !== \"undefined\" && performance !== null) && performance.now) {\n    module.exports = function() {\n      return performance.now();\n    };\n  } else if ((typeof process !== \"undefined\" && process !== null) && process.hrtime) {\n    module.exports = function() {\n      return (getNanoSeconds() - loadTime) / 1e6;\n    };\n    hrtime = process.hrtime;\n    getNanoSeconds = function() {\n      var hr;\n      hr = hrtime();\n      return hr[0] * 1e9 + hr[1];\n    };\n    loadTime = getNanoSeconds();\n  } else if (Date.now) {\n    module.exports = function() {\n      return Date.now() - loadTime;\n    };\n    loadTime = Date.now();\n  } else {\n    module.exports = function() {\n      return new Date().getTime() - loadTime;\n    };\n    loadTime = new Date().getTime();\n  }\n\n}).call(this);\n\n/*\n//@ sourceMappingURL=performance-now.map\n*/\n\n}).call(this,require('_process'))","(function (process,global){\n/*\n\tvar vid = new Whammy.Video();\n\tvid.add(canvas or data url)\n\tvid.compile()\n*/\n\nglobal.Whammy = (function(){\n\t// in this case, frames has a very specific meaning, which will be \n\t// detailed once i finish writing the code\n\n\tfunction toWebM(frames, outputAsArray){\n\t\tvar info = checkFrames(frames);\n\n\t\t//max duration by cluster in milliseconds\n\t\tvar CLUSTER_MAX_DURATION = 30000;\n\t\t\n\t\tvar EBML = [\n\t\t\t{\n\t\t\t\t\"id\": 0x1a45dfa3, // EBML\n\t\t\t\t\"data\": [\n\t\t\t\t\t{ \n\t\t\t\t\t\t\"data\": 1,\n\t\t\t\t\t\t\"id\": 0x4286 // EBMLVersion\n\t\t\t\t\t},\n\t\t\t\t\t{ \n\t\t\t\t\t\t\"data\": 1,\n\t\t\t\t\t\t\"id\": 0x42f7 // EBMLReadVersion\n\t\t\t\t\t},\n\t\t\t\t\t{ \n\t\t\t\t\t\t\"data\": 4,\n\t\t\t\t\t\t\"id\": 0x42f2 // EBMLMaxIDLength\n\t\t\t\t\t},\n\t\t\t\t\t{ \n\t\t\t\t\t\t\"data\": 8,\n\t\t\t\t\t\t\"id\": 0x42f3 // EBMLMaxSizeLength\n\t\t\t\t\t},\n\t\t\t\t\t{ \n\t\t\t\t\t\t\"data\": \"webm\",\n\t\t\t\t\t\t\"id\": 0x4282 // DocType\n\t\t\t\t\t},\n\t\t\t\t\t{ \n\t\t\t\t\t\t\"data\": 2,\n\t\t\t\t\t\t\"id\": 0x4287 // DocTypeVersion\n\t\t\t\t\t},\n\t\t\t\t\t{ \n\t\t\t\t\t\t\"data\": 2,\n\t\t\t\t\t\t\"id\": 0x4285 // DocTypeReadVersion\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": 0x18538067, // Segment\n\t\t\t\t\"data\": [\n\t\t\t\t\t{ \n\t\t\t\t\t\t\"id\": 0x1549a966, // Info\n\t\t\t\t\t\t\"data\": [\n\t\t\t\t\t\t\t{  \n\t\t\t\t\t\t\t\t\"data\": 1e6, //do things in millisecs (num of nanosecs for duration scale)\n\t\t\t\t\t\t\t\t\"id\": 0x2ad7b1 // TimecodeScale\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ \n\t\t\t\t\t\t\t\t\"data\": \"whammy\",\n\t\t\t\t\t\t\t\t\"id\": 0x4d80 // MuxingApp\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ \n\t\t\t\t\t\t\t\t\"data\": \"whammy\",\n\t\t\t\t\t\t\t\t\"id\": 0x5741 // WritingApp\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ \n\t\t\t\t\t\t\t\t\"data\": doubleToString(info.duration),\n\t\t\t\t\t\t\t\t\"id\": 0x4489 // Duration\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"id\": 0x1654ae6b, // Tracks\n\t\t\t\t\t\t\"data\": [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\"id\": 0xae, // TrackEntry\n\t\t\t\t\t\t\t\t\"data\": [\n\t\t\t\t\t\t\t\t\t{  \n\t\t\t\t\t\t\t\t\t\t\"data\": 1,\n\t\t\t\t\t\t\t\t\t\t\"id\": 0xd7 // TrackNumber\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{ \n\t\t\t\t\t\t\t\t\t\t\"data\": 1,\n\t\t\t\t\t\t\t\t\t\t\"id\": 0x63c5 // TrackUID\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{ \n\t\t\t\t\t\t\t\t\t\t\"data\": 0,\n\t\t\t\t\t\t\t\t\t\t\"id\": 0x9c // FlagLacing\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{ \n\t\t\t\t\t\t\t\t\t\t\"data\": \"und\",\n\t\t\t\t\t\t\t\t\t\t\"id\": 0x22b59c // Language\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{ \n\t\t\t\t\t\t\t\t\t\t\"data\": \"V_VP8\",\n\t\t\t\t\t\t\t\t\t\t\"id\": 0x86 // CodecID\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{ \n\t\t\t\t\t\t\t\t\t\t\"data\": \"VP8\",\n\t\t\t\t\t\t\t\t\t\t\"id\": 0x258688 // CodecName\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{ \n\t\t\t\t\t\t\t\t\t\t\"data\": 1,\n\t\t\t\t\t\t\t\t\t\t\"id\": 0x83 // TrackType\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\"id\": 0xe0,  // Video\n\t\t\t\t\t\t\t\t\t\t\"data\": [\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\"data\": info.width,\n\t\t\t\t\t\t\t\t\t\t\t\t\"id\": 0xb0 // PixelWidth\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t{ \n\t\t\t\t\t\t\t\t\t\t\t\t\"data\": info.height,\n\t\t\t\t\t\t\t\t\t\t\t\t\"id\": 0xba // PixelHeight\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\n\t\t\t\t\t//cluster insertion point\n\t\t\t\t]\n\t\t\t}\n\t\t ];\n\n\t\t\t\t\t\t\n\t\t//Generate clusters (max duration)\n\t\tvar frameNumber = 0;\n\t\tvar clusterTimecode = 0;\n\t\twhile(frameNumber < frames.length){\n\t\t\t\n\t\t\tvar clusterFrames = [];\n\t\t\tvar clusterDuration = 0;\n\t\t\tdo {\n\t\t\t\tclusterFrames.push(frames[frameNumber]);\n\t\t\t\tclusterDuration += frames[frameNumber].duration;\n\t\t\t\tframeNumber++;\t\t\t\t\n\t\t\t}while(frameNumber < frames.length && clusterDuration < CLUSTER_MAX_DURATION);\n\t\t\t\t\t\t\n\t\t\tvar clusterCounter = 0;\t\t\t\n\t\t\tvar cluster = {\n\t\t\t\t\t\"id\": 0x1f43b675, // Cluster\n\t\t\t\t\t\"data\": [\n\t\t\t\t\t\t{  \n\t\t\t\t\t\t\t\"data\": clusterTimecode,\n\t\t\t\t\t\t\t\"id\": 0xe7 // Timecode\n\t\t\t\t\t\t}\n\t\t\t\t\t].concat(clusterFrames.map(function(webp){\n\t\t\t\t\t\tvar block = makeSimpleBlock({\n\t\t\t\t\t\t\tdiscardable: 0,\n\t\t\t\t\t\t\tframe: webp.data.slice(4),\n\t\t\t\t\t\t\tinvisible: 0,\n\t\t\t\t\t\t\tkeyframe: 1,\n\t\t\t\t\t\t\tlacing: 0,\n\t\t\t\t\t\t\ttrackNum: 1,\n\t\t\t\t\t\t\ttimecode: Math.round(clusterCounter)\n\t\t\t\t\t\t});\n\t\t\t\t\t\tclusterCounter += webp.duration;\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tdata: block,\n\t\t\t\t\t\t\tid: 0xa3\n\t\t\t\t\t\t};\n\t\t\t\t\t}))\n\t\t\t\t}\n\t\t\t\n\t\t\t//Add cluster to segment\n\t\t\tEBML[1].data.push(cluster);\t\t\t\n\t\t\tclusterTimecode += clusterDuration;\n\t\t}\n\t\t\t\t\t\t\n\t\treturn generateEBML(EBML, outputAsArray)\n\t}\n\n\t// sums the lengths of all the frames and gets the duration, woo\n\n\tfunction checkFrames(frames){\n\t\tvar width = frames[0].width, \n\t\t\theight = frames[0].height, \n\t\t\tduration = frames[0].duration;\n\t\tfor(var i = 1; i < frames.length; i++){\n\t\t\tif(frames[i].width != width) throw \"Frame \" + (i + 1) + \" has a different width\";\n\t\t\tif(frames[i].height != height) throw \"Frame \" + (i + 1) + \" has a different height\";\n\t\t\tif(frames[i].duration < 0 || frames[i].duration > 0x7fff) throw \"Frame \" + (i + 1) + \" has a weird duration (must be between 0 and 32767)\";\n\t\t\tduration += frames[i].duration;\n\t\t}\n\t\treturn {\n\t\t\tduration: duration,\n\t\t\twidth: width,\n\t\t\theight: height\n\t\t};\n\t}\n\n\n\tfunction numToBuffer(num){\n\t\tvar parts = [];\n\t\twhile(num > 0){\n\t\t\tparts.push(num & 0xff)\n\t\t\tnum = num >> 8\n\t\t}\n\t\treturn new Uint8Array(parts.reverse());\n\t}\n\n\tfunction strToBuffer(str){\n\t\t// return new Blob([str]);\n\n\t\tvar arr = new Uint8Array(str.length);\n\t\tfor(var i = 0; i < str.length; i++){\n\t\t\tarr[i] = str.charCodeAt(i)\n\t\t}\n\t\treturn arr;\n\t\t// this is slower\n\t\t// return new Uint8Array(str.split('').map(function(e){\n\t\t// \treturn e.charCodeAt(0)\n\t\t// }))\n\t}\n\n\n\t//sorry this is ugly, and sort of hard to understand exactly why this was done\n\t// at all really, but the reason is that there's some code below that i dont really\n\t// feel like understanding, and this is easier than using my brain.\n\n\tfunction bitsToBuffer(bits){\n\t\tvar data = [];\n\t\tvar pad = (bits.length % 8) ? (new Array(1 + 8 - (bits.length % 8))).join('0') : '';\n\t\tbits = pad + bits;\n\t\tfor(var i = 0; i < bits.length; i+= 8){\n\t\t\tdata.push(parseInt(bits.substr(i,8),2))\n\t\t}\n\t\treturn new Uint8Array(data);\n\t}\n\n\tfunction generateEBML(json, outputAsArray){\n\t\tvar ebml = [];\n\t\tfor(var i = 0; i < json.length; i++){\n\t\t\tvar data = json[i].data;\n\t\t\tif(typeof data == 'object') data = generateEBML(data, outputAsArray);\t\t\t\t\t\n\t\t\tif(typeof data == 'number') data = bitsToBuffer(data.toString(2));\n\t\t\tif(typeof data == 'string') data = strToBuffer(data);\n\n\t\t\tif(data.length){\n\t\t\t\tvar z = z;\n\t\t\t}\n\t\t\t\n\t\t\tvar len = data.size || data.byteLength || data.length;\n\t\t\tvar zeroes = Math.ceil(Math.ceil(Math.log(len)/Math.log(2))/8);\n\t\t\tvar size_str = len.toString(2);\n\t\t\tvar padded = (new Array((zeroes * 7 + 7 + 1) - size_str.length)).join('0') + size_str;\n\t\t\tvar size = (new Array(zeroes)).join('0') + '1' + padded;\n\t\t\t\n\t\t\t//i actually dont quite understand what went on up there, so I'm not really\n\t\t\t//going to fix this, i'm probably just going to write some hacky thing which\n\t\t\t//converts that string into a buffer-esque thing\n\n\t\t\tebml.push(numToBuffer(json[i].id));\n\t\t\tebml.push(bitsToBuffer(size));\n\t\t\tebml.push(data)\n\t\t\t\n\n\t\t}\n\t\t\n\t\t//output as blob or byteArray\n\t\tif(outputAsArray){\n\t\t\t//convert ebml to an array\n\t\t\tvar buffer = toFlatArray(ebml)\n\t\t\treturn new Uint8Array(buffer);\n\t\t}else{\n\t\t\treturn new Blob(ebml, {type: \"video/webm\"});\n\t\t}\n\t}\n\t\n\tfunction toFlatArray(arr, outBuffer){\n\t\tif(outBuffer == null){\n\t\t\toutBuffer = [];\n\t\t}\n\t\tfor(var i = 0; i < arr.length; i++){\n\t\t\tif(typeof arr[i] == 'object'){\n\t\t\t\t//an array\n\t\t\t\ttoFlatArray(arr[i], outBuffer)\n\t\t\t}else{\n\t\t\t\t//a simple element\n\t\t\t\toutBuffer.push(arr[i]);\n\t\t\t}\n\t\t}\n\t\treturn outBuffer;\n\t}\n\t\n\t//OKAY, so the following two functions are the string-based old stuff, the reason they're\n\t//still sort of in here, is that they're actually faster than the new blob stuff because\n\t//getAsFile isn't widely implemented, or at least, it doesn't work in chrome, which is the\n\t// only browser which supports get as webp\n\n\t//Converting between a string of 0010101001's and binary back and forth is probably inefficient\n\t//TODO: get rid of this function\n\tfunction toBinStr_old(bits){\n\t\tvar data = '';\n\t\tvar pad = (bits.length % 8) ? (new Array(1 + 8 - (bits.length % 8))).join('0') : '';\n\t\tbits = pad + bits;\n\t\tfor(var i = 0; i < bits.length; i+= 8){\n\t\t\tdata += String.fromCharCode(parseInt(bits.substr(i,8),2))\n\t\t}\n\t\treturn data;\n\t}\n\n\tfunction generateEBML_old(json){\n\t\tvar ebml = '';\n\t\tfor(var i = 0; i < json.length; i++){\n\t\t\tvar data = json[i].data;\n\t\t\tif(typeof data == 'object') data = generateEBML_old(data);\n\t\t\tif(typeof data == 'number') data = toBinStr_old(data.toString(2));\n\t\t\t\n\t\t\tvar len = data.length;\n\t\t\tvar zeroes = Math.ceil(Math.ceil(Math.log(len)/Math.log(2))/8);\n\t\t\tvar size_str = len.toString(2);\n\t\t\tvar padded = (new Array((zeroes * 7 + 7 + 1) - size_str.length)).join('0') + size_str;\n\t\t\tvar size = (new Array(zeroes)).join('0') + '1' + padded;\n\n\t\t\tebml += toBinStr_old(json[i].id.toString(2)) + toBinStr_old(size) + data;\n\n\t\t}\n\t\treturn ebml;\n\t}\n\n\t//woot, a function that's actually written for this project!\n\t//this parses some json markup and makes it into that binary magic\n\t//which can then get shoved into the matroska comtainer (peaceably)\n\n\tfunction makeSimpleBlock(data){\n\t\tvar flags = 0;\n\t\tif (data.keyframe) flags |= 128;\n\t\tif (data.invisible) flags |= 8;\n\t\tif (data.lacing) flags |= (data.lacing << 1);\n\t\tif (data.discardable) flags |= 1;\n\t\tif (data.trackNum > 127) {\n\t\t\tthrow \"TrackNumber > 127 not supported\";\n\t\t}\n\t\tvar out = [data.trackNum | 0x80, data.timecode >> 8, data.timecode & 0xff, flags].map(function(e){\n\t\t\treturn String.fromCharCode(e)\n\t\t}).join('') + data.frame;\n\n\t\treturn out;\n\t}\n\n\t// here's something else taken verbatim from weppy, awesome rite?\n\n\tfunction parseWebP(riff){\n\t\tvar VP8 = riff.RIFF[0].WEBP[0];\n\t\t\n\t\tvar frame_start = VP8.indexOf('\\x9d\\x01\\x2a'); //A VP8 keyframe starts with the 0x9d012a header\n\t\tfor(var i = 0, c = []; i < 4; i++) c[i] = VP8.charCodeAt(frame_start + 3 + i);\n\t\t\n\t\tvar width, horizontal_scale, height, vertical_scale, tmp;\n\t\t\n\t\t//the code below is literally copied verbatim from the bitstream spec\n\t\ttmp = (c[1] << 8) | c[0];\n\t\twidth = tmp & 0x3FFF;\n\t\thorizontal_scale = tmp >> 14;\n\t\ttmp = (c[3] << 8) | c[2];\n\t\theight = tmp & 0x3FFF;\n\t\tvertical_scale = tmp >> 14;\n\t\treturn {\n\t\t\twidth: width,\n\t\t\theight: height,\n\t\t\tdata: VP8,\n\t\t\triff: riff\n\t\t}\n\t}\n\n\t// i think i'm going off on a riff by pretending this is some known\n\t// idiom which i'm making a casual and brilliant pun about, but since\n\t// i can't find anything on google which conforms to this idiomatic\n\t// usage, I'm assuming this is just a consequence of some psychotic\n\t// break which makes me make up puns. well, enough riff-raff (aha a\n\t// rescue of sorts), this function was ripped wholesale from weppy\n\n\tfunction parseRIFF(string){\n\t\tvar offset = 0;\n\t\tvar chunks = {};\n\t\t\n\t\twhile (offset < string.length) {\n\t\t\tvar id = string.substr(offset, 4);\n\t\t\tvar len = parseInt(string.substr(offset + 4, 4).split('').map(function(i){\n\t\t\t\tvar unpadded = i.charCodeAt(0).toString(2);\n\t\t\t\treturn (new Array(8 - unpadded.length + 1)).join('0') + unpadded\n\t\t\t}).join(''),2);\n\t\t\tvar data = string.substr(offset + 4 + 4, len);\n\t\t\toffset += 4 + 4 + len;\n\t\t\tchunks[id] = chunks[id] || [];\n\t\t\t\n\t\t\tif (id == 'RIFF' || id == 'LIST') {\n\t\t\t\tchunks[id].push(parseRIFF(data));\n\t\t\t} else {\n\t\t\t\tchunks[id].push(data);\n\t\t\t}\n\t\t}\n\t\treturn chunks;\n\t}\n\n\t// here's a little utility function that acts as a utility for other functions\n\t// basically, the only purpose is for encoding \"Duration\", which is encoded as\n\t// a double (considerably more difficult to encode than an integer)\n\tfunction doubleToString(num){\n\t\treturn [].slice.call(\n\t\t\tnew Uint8Array(\n\t\t\t\t(\n\t\t\t\t\tnew Float64Array([num]) //create a float64 array\n\t\t\t\t).buffer) //extract the array buffer\n\t\t\t, 0) // convert the Uint8Array into a regular array\n\t\t\t.map(function(e){ //since it's a regular array, we can now use map\n\t\t\t\treturn String.fromCharCode(e) // encode all the bytes individually\n\t\t\t})\n\t\t\t.reverse() //correct the byte endianness (assume it's little endian for now)\n\t\t\t.join('') // join the bytes in holy matrimony as a string\n\t}\n\n\tfunction WhammyVideo(speed, quality){ // a more abstract-ish API\n\t\tthis.frames = [];\n\t\tthis.duration = 1000 / speed;\n\t\tthis.quality = quality || 0.8;\n\t}\n\n\tWhammyVideo.prototype.add = function(frame, duration){\n\t\tif(typeof duration != 'undefined' && this.duration) throw \"you can't pass a duration if the fps is set\";\n\t\tif(typeof duration == 'undefined' && !this.duration) throw \"if you don't have the fps set, you ned to have durations here.\"\n\t\tif('canvas' in frame){ //CanvasRenderingContext2D\n\t\t\tframe = frame.canvas;\t\n\t\t}\n\t\tif('toDataURL' in frame){\n\t\t\tframe = frame.toDataURL('image/webp', this.quality)\n\t\t}else if(typeof frame != \"string\"){\n\t\t\tthrow \"frame must be a a HTMLCanvasElement, a CanvasRenderingContext2D or a DataURI formatted string\"\n\t\t}\n\t\tif (!(/^data:image\\/webp;base64,/ig).test(frame)) {\n\t\t\tthrow \"Input must be formatted properly as a base64 encoded DataURI of type image/webp\";\n\t\t}\n\t\tthis.frames.push({\n\t\t\timage: frame,\n\t\t\tduration: duration || this.duration\n\t\t})\n\t}\n\t\n\tWhammyVideo.prototype.compile = function(outputAsArray){\n\t\treturn new toWebM(this.frames.map(function(frame){\n\t\t\tvar webp = parseWebP(parseRIFF(atob(frame.image.slice(23))));\n\t\t\twebp.duration = frame.duration;\n\t\t\treturn webp;\n\t\t}), outputAsArray)\n\t}\n\n\treturn {\n\t\tVideo: WhammyVideo,\n\t\tfromImageArray: function(images, fps, outputAsArray){\n\t\t\treturn toWebM(images.map(function(image){\n\t\t\t\tvar webp = parseWebP(parseRIFF(atob(image.slice(23))))\n\t\t\t\twebp.duration = 1000 / fps;\n\t\t\t\treturn webp;\n\t\t\t}), outputAsArray)\n\t\t},\n\t\ttoWebM: toWebM\n\t\t// expose methods of madness\n\t}\n})();\n\nif (typeof process !== 'undefined') module.exports = Whammy;\n\n}).call(this,require('_process'),typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})","var BottomBar = require('../BottomBar');\nvar ChatMessage = require('../ChatMessage');\n\nvar Application = React.createClass({\n  displayName: 'Application',\n  propTypes: {\n    socket: React.PropTypes.object.isRequired\n  },\n\n  getInitialState: function() {\n    return {\n      messages: []\n    };\n  },\n\n  componentWillMount: function() {\n    this.props.socket.on('message', this.addMessage);\n  },\n\n  addMessage: function(msg) {\n    var msgs = this.state.messages;\n    msgs.unshift({\n      key: msg.video,\n      id: msg.video,\n      text: msg.text,\n      url: '/video/'+msg.video\n    });\n    this.setState({messages: msgs});\n  },\n\n  sendMessage: function(txt, vid) {\n    var formData = new FormData();\n    formData.append('text', txt);\n    formData.append('video', vid);\n\n    var req = new XMLHttpRequest();\n    req.open('POST', '/upload', true);\n    req.send(formData);\n  },\n\n  render: function() {\n    var bar = BottomBar({\n      ref: 'bottomBar',\n      key: 'bottomBar',\n      recordTime: 4000,\n      onSubmit: this.sendMessage\n    });\n\n\n    var msgs = React.DOM.div({\n      className: 'message-wall',\n      key: 'messageWall',\n      ref: 'messageWall'\n    }, this.state.messages.map(ChatMessage));\n\n    var container = React.DOM.div({\n      className: 'application'\n    }, [msgs, bar]);\n\n    return container;\n  }\n});\n\nmodule.exports = Application;","var CaptureMedia = require('../CaptureMedia');\n\nvar BottomBar = React.createClass({\n  mixins: [React.addons.LinkedStateMixin],\n\n  displayName: 'BottomBar',\n  propTypes: {\n    recordTime: React.PropTypes.number.isRequired,\n    onSubmit: React.PropTypes.func.isRequired\n  },\n\n  getInitialState: function() {\n    return {\n      locked: true\n    };\n  },\n\n  submit: function() {\n    this.setState({locked: true});\n    var txt = this.state.text;\n    this.refs.selfie.record(this.props.recordTime, function(blob){\n      this.props.onSubmit(txt, blob);\n\n      // unlock and reset input\n      this.setState({\n        locked: false,\n        text: ''\n      });\n    }.bind(this));\n  },\n\n  handleKeyPress: function(e) {\n    // on input keypress, check for Enter key\n    if (e.which === 13) {\n      this.submit();\n    }\n  },\n\n  hasStream: function(stream) {\n    this.setState({\n      locked: false\n    });\n  },\n\n  render: function() {\n    if (!window.chrome) {\n      return null;\n    }\n\n    var selfie = CaptureMedia({\n      ref: 'selfie',\n      key: 'selfie',\n      className: 'bottom-bar-selfie',\n      onStream: this.hasStream\n    });\n\n    var txt = React.DOM.input({\n      ref: 'txt',\n      key: 'txt',\n      placeholder: 'Type a message...',\n      onKeyPress: this.handleKeyPress,\n      disabled: this.state.locked,\n      className: 'bottom-bar-text',\n      valueLink: this.linkState('text')\n    });\n\n    return React.DOM.div({\n      ref: 'container',\n      className: 'bottom-bar'\n    }, [selfie, txt]);\n  }\n});\n\nmodule.exports = BottomBar;","var gum = require('getusermedia');\nvar record = require('./record');\n\nvar QVGA = {\n  minFrameRate: 30,\n  minWidth: 320,\n  minHeight: 240\n};\n\nvar videoConstraints = {\n  mandatory: QVGA,\n  optional: [\n    {facingMode: 'user'}\n  ]\n};\n\nvar CaptureMedia = React.createClass({\n  displayName: 'CaptureMedia',\n  propTypes: {\n    onStream: React.PropTypes.func\n  },\n\n  getInitialState: function() {\n    return {\n      stream: null,\n      src: null\n    };\n  },\n\n  componentWillMount: function() {\n    gum({video: true, audio: false}, this.handleGUM);\n  },\n\n  handleGUM: function(err, stream){\n    if (!stream) {\n      return console.error(err);\n    }\n\n    this.setState({\n      stream: stream,\n      src: URL.createObjectURL(stream)\n    });\n    if (this.props.onStream) {\n      this.props.onStream(stream);\n    }\n  },\n\n  record: function(time, cb) {\n    record(this.refs.videoElement.getDOMNode(), time, cb);\n  },\n\n  render: function() {\n    return React.DOM.video({\n      ref: 'videoElement',\n      src: this.state.src,\n      muted: true,\n      autoPlay: true,\n      className: this.props.className,\n      style: this.props.style\n    });\n  }\n});\n\nmodule.exports = CaptureMedia;","var whammy = require('whammy');\nvar raf = require('raf');\n\nvar vid = document.createElement('video');\nvar can = document.createElement('canvas');\n\nmodule.exports = function(el, time, cb) {\n  var encoder = new whammy.Video(30, 1);\n  //delete encoder.duration; // hack\n\n  var w = el.videoWidth;\n  var h = el.videoHeight;\n  can.width = w;\n  can.height = h;\n  vid.width = w;\n  vid.height = h;\n  vid.src = el.src;\n\n  var ctx = can.getContext('2d');\n  var start = Date.now();\n  var last = start;\n\n  var grab = function(){\n    var since = Date.now()-start;\n\n    if (since >= time) {\n      return done();\n    }\n\n    raf(grab);\n    ctx.drawImage(vid, 0, 0, w, h);\n    encoder.add(ctx);\n  };\n\n  var done = function(){\n    var output = encoder.compile();\n    vid.src = '';\n    vid.pause();\n    vid.removeEventListener('playing', grab, false);\n    cb(output);\n  };\n\n  vid.addEventListener('playing', grab, false);\n  vid.play();\n};","var ChatMessage = React.createClass({\n  displayName: 'ChatMessage',\n  propTypes: {\n    id: React.PropTypes.string.isRequired,\n    url: React.PropTypes.string.isRequired,\n    text: React.PropTypes.string\n  },\n\n  getDefaultProps: function() {\n    return {\n      text: ''\n    };\n  },\n\n  render: function() {\n    var vid = React.DOM.img({\n      ref: 'video',\n      key: 'video',\n      src: this.props.url,\n      loop: true,\n      controls: false,\n      autoPlay: true,\n      className: 'chat-message-video'\n    });\n\n    var msg = this.props.text ? React.DOM.div({\n      ref: 'text',\n      key: 'text',\n      className: 'chat-message-text'\n    }, this.props.text) : null;\n\n    return React.DOM.div({\n      ref: 'container',\n      className: 'chat-message'\n    }, [vid, msg]);\n  }\n});\n\nmodule.exports = ChatMessage;"],"sourceRoot":"/source/"}